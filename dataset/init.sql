
CREATE TABLE IF NOT EXISTS product
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 11 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    brand character varying(255),
    name character varying(255),
    price integer NOT NULL,
    description character varying(255),
    release_date timestamp(6) without time zone,
    product_available boolean,
    stock_quantity integer,
    category character varying(255),
    CONSTRAINT product_pkey PRIMARY KEY (id)
);



CREATE TABLE IF NOT EXISTS image
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    image_data bytea,
    image_name character varying(255),
    image_type character varying(255),
    product_id integer,
    CONSTRAINT image_pkey PRIMARY KEY (id),
    CONSTRAINT product_key UNIQUE (product_id),
    CONSTRAINT product_fkey FOREIGN KEY (product_id)
        REFERENCES product (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);



CREATE TABLE IF NOT EXISTS users
(
    username character varying(255),
    password character varying(255),
    CONSTRAINT users_pk PRIMARY KEY (username)
);

COPY product
FROM '/docker-entrypoint-initdb.d/product.csv'
DELIMITER ','
CSV HEADER;

COPY image
FROM '/docker-entrypoint-initdb.d/image.csv'
DELIMITER ','
CSV HEADER;

COPY users
FROM '/docker-entrypoint-initdb.d/users.csv'
DELIMITER ','
CSV HEADER;